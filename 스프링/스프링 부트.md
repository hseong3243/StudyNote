#### jar과 war
---
##### WAR(Web Application Archive)
WAR 파일을 웹 애플리케이션 서버에 배포할 때 사용하는 파일입니다. 웹 애플리케이션 서버 위에서 실행되고 HTML 같은 정적 리소스와 클래스 파일을 모두 포함하기 때문에 JAR에 비해 구조가 복잡한니다.
##### JAR(Java Archive)
자바는 여래 클래스와 리소스를 묶어서 jar이라고 하는 압축 파일을 만들 수 있습니다. JVM 위에서 직접 실행되거나 다른 곳에서 사용하는 라이브러리로 제공됩니다.

jar 파일은 내부에 라이브러리 역할을 하는 jar 파일을 포함할 수 없습니다. 이를 위한 대안으로 FatJar이라는 방법이 있습니다.
##### FatJar
jar 안에 jar을 포함할 수는 없지만 클래스는 포함할 수 있습니다. 라이브러리의 jar을 모두 풀어서 새로운 jar에 라이브러리의 class를 집어 넣어준 것이 FatJar입니다. 

FatJar을 이용하면 톰캣 같은 WAS를 라이브러리로 jar 내부에 포함할 수 있으며 단순히 `main()` 메서드만 실행하면 프로그램을 실행시킬 수 있습니다. 그러나 클래스나 리소스 이름의 중복을 해결할 수 없고 어떤 라이브러리가 포함되어 있는지 파악하기 어렵습니다.
##### 스프링 부트 실행 가능 Jar(Executable Jar)
스프링 부트는 jar 내부에 jar을 포함할 수 있는 특별한 구조의 jar을 만들었습니다. 이를 실행 가능 Jar이라고 합니다. jar 내부에 jar을 포함하기 때문에 어떤 라이브러리가 포함되어 있는지 쉽게 확인 가능하고 파일명 중복을 해결할 수 있습니다.
##### Jar 실행 시
jar 파일을 실행하게 되면 `META-INF/MANIFEST.MF` 파일을 찾습니다. 내부 jar을 읽어들이기 위한 `JarLauncher`를 실행하고 `main()` 메서드를 실행합니다.

#### 스타터 의존성
---
스프링 부트는 잘 알려진 라이브러리의 버전 정보를 직접 관리해주고 프로젝트를 시작하는데 필요한 관련 라이브러리들을 모아둔 스타터 의존성을 제공합니다.

#### 자동 구성(Auto Configuration)
---
스프링 부트는 일반적으로 자주 사용하는 수많은 빈들을 자동으로 등록해줍니다. 덕분에 개발자는 반복적이고 복잡한 빈 등록과 설정을 최소화할 수 있습니다.

#### 외부 설정
---
##### 커맨드 라인 옵션 인수
스프링은 커맨드 라인 인수를 `key=value` 형식으로 사용할 수 있는 방법을 제공합니다.
```
java -jar application.jar --key=value
```
##### 외부 설정 사용 추상화
스프링 부트는 커맨드 라인 옵션 인수, 자바 시스템 속성 등의 외부 설정을 편리하게 사용할 수 있도록 추상화하였습니다. 개발자는 `Environment`를 주입받아 편리한 방법으로 읽어올 수 있습니다.
##### properties
개발자는 `application.properties`라는 파일을 자바 실행 위치에 만들어두면 스프링이 이를 읽어 `PropertySource`의 구현체를 제공합니다.
##### 프로필
스프링은 프로필 기능을 통해서 실행 환경에 따라서 다양한 설정을 미리 정의할 수 있도록 지원합니다. 
```
application-dev.yml
application-prod.yml
```

개발자는 jar 실행시에 커맨드 라인 옵션 인수 또는 자바 시스템 속성을 사용하면 프로필을 정할 수 있습니다.
```bash
java -jar application.jar --spring.profiles.active=dev
```

설정 파일을 나눌 수도 있지만 합치기 위해서는 properties 파일의 경우 `#---`로, yml 파일의 경우 `---`로 프로필을 나눌 수 있습니다. 설정은 순차적으로 적용되기 때문에 일부만 설정 정보가 다르다면 다음과 같이 구성할 수도 있습니다.
```properties
url=db
username=root
password=root

---

spring.config.activate.on-profile=dev
url=dev_db
```
##### 외부 설정 조회
외부 설정을 조회하는 방법은 `Environment`, `@Value`, `@ConfigurationProperties`가 있습니다.

`@Value`는 필드, 파라미터에 사용 가능합니다.
```java
@Configuration
public class Config {

	@Value("${hello.url}")
	private String url;

	@Bean
	public Hello hello(
		@Value("${hello.url}") String url;
	) {}
}
```

`@ConfigurationProperties`는 객체에 해당 어노테이션과 key의 묶음을 전달해주면 설정값을 주입해줍니다. 이를 적용하기 위해서는 `@EnableConfigurationProperties(HelloProperties.class)` 혹은 `@ConfigurationPropertiesScan`을 추가하여 적절하게 스캔이 이루어지도록 해야 합니다.
```java
@Setter
@Getter
@ConfigurationProperties("hello")
public class HelloProperties {

	private String url;

}
```

프로퍼티 방식 대신 생성자 주입을 이용할 수도 있습니다. 만일 생성자가 둘 이상인 경우에는 `@ConstructorBinding` 어노테이션을 생성자에 적용해야 합니다.
```java
@Getter
@ConfigurationProperties("hello")
public class HelloProperties {

	private final String url;

	public HelloProperties(String url) {
		this.url = url;
	}
}
```

## 참고
---
김영한님의 스프링 부트